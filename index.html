<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Bengaluru Metro — Map & Timings</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
  :root{
    --purple:#7c3aed; --green:#10b981; --yellow:#f59e0b;
    --ink:#e5e7eb; --muted:#94a3b8; --bg:#0b1120; --card:#0e1726; --hair:#1e293b;
  }
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial}
  .wrap{max-width:1100px;margin:22px auto;padding:0 12px}
  h1{font-size:clamp(22px,6vw,40px);margin:0 0 6px;text-align:center}
  .sub{color:var(--muted);text-align:center;margin:0 0 14px}
  .map-wrap{background:var(--card);border:1px solid var(--hair);border-radius:14px;overflow:hidden}

  /* Fold-1 map height */
  #map{height:clamp(560px,72vh,840px)}

  .legend{
    display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center;margin:10px 0 0
  }
  .key{display:inline-flex;align-items:center;gap:6px;color:#cbd5e1;font-size:13px}
  .dot{width:10px;height:10px;border-radius:50%}
  .dot.purple{background:var(--purple)} .dot.green{background:var(--green)} .dot.yellow{background:var(--yellow)}
  .leaflet-tooltip{font-weight:600}
  .att{color:#64748b;text-align:center;font-size:12px;margin-top:6px}

  /* Mobile: map ≈80% height + comfy zoom buttons */
  @media (max-width:640px){
    :root{ --fold-offset: 210px; }
    #map{ height: min(80vh, calc(100vh - var(--fold-offset))); }
    .leaflet-bottom.leaflet-right{ right:12px; bottom:calc(12px + env(safe-area-inset-bottom)); }
    .leaflet-control-zoom a{
      width:44px;height:44px;line-height:44px;font-size:20px;border-radius:12px!important;
    }
    h1{ font-size:clamp(22px,6.2vw,28px) } .sub{ font-size:14px }
  }
  /* soften zoom buttons on dark bg */
  .leaflet-control-zoom a{ border-radius:10px!important; }

  /* ===== Fold-2 base container (feature-specific styles are injected by the module) ===== */
  #fold2{ margin:40px auto 26px; max-width:1100px; padding:0 12px; }
  #fold2 h2{ text-align:center; margin:0 0 10px; font-size: clamp(18px,4.8vw,26px); }
</style>
</head>
<body>
  <div class="wrap">
    <h1>Bengaluru’s “Namma Metro” — Map & Timings</h1>
    <p class="sub">Metro routes, timings, frequencies all in one place</p>

    <!-- Fold-1: Map -->
    <div class="map-wrap">
      <div id="map" role="region" aria-label="Bengaluru Metro map"></div>
    </div>

    <div class="legend" aria-hidden="true">
      <span class="key"><span class="dot purple"></span>PURPLE</span>
      <span class="key"><span class="dot green"></span>GREEN</span>
      <span class="key"><span class="dot yellow"></span>YELLOW</span>
    </div>
    <div class="att">Map data © OpenStreetMap contributors • Tiles from OSM</div>
  </div>

  <!-- Fold-2: Route Diagram -->
  <section id="fold2" class="wrap">
    <h2>Metro Route &amp; Timings</h2>
    <div id="lineChips" role="tablist" aria-label="Choose metro line">
      <button class="chip" data-line="PURPLE" role="tab" aria-selected="true">Purple Line</button>
      <button class="chip" data-line="GREEN"  role="tab" aria-selected="false">Green Line</button>
      <button class="chip" data-line="YELLOW" role="tab" aria-selected="false">Yellow Line</button>
    </div>
    <div class="card">
      <svg id="stationsSvg" viewBox="0 0 1200 360" width="100%" height="360" aria-label="Metro route diagram"></svg>
    </div>
  </section>

  <!-- Scripts: Leaflet core, then your feature modules -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script type="module">
    import { init as initMap } from '/assets/feature-map.js';
    import { init as initDiagram } from '/assets/feature-diagram.js';

    // Both features read the same data file
    const DATA_URL = '/data/stations.geojson';

    // Fold-1
    initMap({ containerId: 'map', dataUrl: DATA_URL });

    // Fold-2
    initDiagram({ svgId: 'stationsSvg', chipsId: 'lineChips', dataUrl: DATA_URL });
  </script>
</body>
</html>
